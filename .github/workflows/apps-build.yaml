name: "Applications GHA - Build"
run-name: "APPS BUILD"
on: [push, workflow_dispatch]
jobs:
  appsBuild:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Setup Node
        uses: actions/setup-node@v4
        with:
          node-version: 18.20.8
          cache: "yarn"
          cache-dependency-path: applications/yarn.lock

      - name: Cache Nx
        uses: actions/cache@v4
        with:
          path: applications/node_modules/.cache/nx
          key: nx-apps-${{ runner.os }}-${{ hashFiles('applications/yarn.lock', 'applications/lerna.json', 'applications/nx.json') }}
          restore-keys: |
            nx-apps-${{ runner.os }}-

      - name: Install packages
        run: yarn install --frozen-lockfile
        working-directory: ./applications

      - name: Run build
        run: yarn build
        working-directory: ./applications